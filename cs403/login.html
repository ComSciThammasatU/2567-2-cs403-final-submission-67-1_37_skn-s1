<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</title>
    <link rel="icon" href="image/logo.png"  type="image/x-icon">
    <!-- swiper -->
    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <!-- box icon import -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- css -->
    <link rel="stylesheet" href="css/preloader.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/navigationbar.css">
    <link rel="stylesheet" href="css/footer.css">
    <!-- login css -->
    <link rel="stylesheet" href="css/pageStyle/login.css">
</head>
<body>


<!----  NAVIGATION BAR (navigationBar.js)---->
<nav></nav>

<!--GENERAL BANNER SECTION-->
<section class="sectionBanner">
    <div class="container">
        <div class="content">
            <h2>‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</h2>
            <p><span>‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</span>
                <span>/</span>
                <span>‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</span>
            </p>
        </div>
    </div>
</section>

<!-- LOGIN SECTION -->
<section class="login">
    <div class="container">
        <div class="loginContent">
            <div class="loginLeftBx">
                <div class="image"><img src="https://www.prd.go.th/th/file/get/file/202311102a52182bf78a8cbc7d17761023abb4cc111809.png" alt=""></div>
            </div>
            <div class="loginRightBx">
                <div class="header">
                    <h2>‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</h2>
                    <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤! ‚ôªÔ∏è‚ú® ‡∏´‡∏ß‡∏±‡∏á‡∏ß‡πà‡∏≤‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏¢‡∏∞‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô üåç ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏∞!</p>
                </div>
                <form id="loginForm">
                <div class="inputBx">
                    <input type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" id="usernameInput" name="username">
                    <p class="errTx"></p>
                </div>
                <div class="inputBx">
                    <input type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô..." id="pwdInput" name="password">
                    <p class="errTx"></p>
                </div>

                <button class="submitLogin" type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                <a href="./signup.html" class="noHaveAccTx">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
                </form>
            </div>
        </div>
    </div>
</section>


<!-- import box icon -->
<script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
<!-- import Swiper script -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<!-- import SweetAlert 2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!--All script -->
<script src="./js/swiperScript/allSwiper.js"></script>
<script src="./js/preloader.js"></script>
<script src="./js/navigationBar.js"></script>
<script src="./js/footer.js"></script>

<script>
    const loginForm = document.getElementById('loginForm');
    loginForm.addEventListener('submit', function (event) {
        event.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ reload ‡∏´‡∏ô‡πâ‡∏≤

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á FormData object ‡∏à‡∏≤‡∏Å form
        const formData = new FormData(loginForm);

        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á login.php
        fetch('login.php', {
    method: 'POST',
    body: formData
})
.then(response => response.json())
.then(data => {
    if (data.status === 'success') {
        // --- ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ---
        // ‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:
        // const userId = data.user.id;
        // sessionStorage.setItem('userId', userId); // ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏±‡πâ‡∏á object
        // sessionStorage.setItem('userData', JSON.stringify(data.user)); // <-- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ

        // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ ***
        const userData = data.userData; // ‡∏£‡∏±‡∏ö object userData ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ userData ‡πÅ‡∏•‡∏∞ user_id ‡∏à‡∏£‡∏¥‡∏á‡πÜ
        if (userData && userData.user_id) {
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏•‡∏á sessionStorage (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô array ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà status_org.html ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á)
            sessionStorage.setItem('userData', JSON.stringify([userData])); // <-- ‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô [userData]

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö user_type ‡πÄ‡∏û‡∏∑‡πà‡∏≠ redirect
            if (userData.user_type === 'organization') {
                window.location.href = 'index1.html'; // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
            } else {
                window.location.href = 'index.html'; // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
            }
        } else {
             // ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• userData ‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å PHP
             console.error('Login successful but userData is missing or incomplete:', data);
             alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå');
        }
        // --- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ---

    } else {
        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏à‡∏≤‡∏Å data.message
        alert('Login failed: ' + data.message);
    }
})
.catch(error => {
    console.error('Error:', error);
    alert('An error occurred during login.');
});

    });
</script>